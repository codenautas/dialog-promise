<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Dialog Promise examples</title>
    <link rel="stylesheet" type="text/css" href="popup-dp.css">
    <link rel="stylesheet" type="text/css" href="../lib/dialog-promise.css">
  </head>
  <body>
    <h1>Dialog Promise examples</h1>
    <p>
      <button id=alert_example1>Alert example</button>
    </p>
    <p>
      <button id=confirm_example1>Confirm example</button>
    </p>
    <p>
      <button id=prompt_example1>Prompt example</button>
    </p>
    <p>
      <button id=toggle_close>Toggle close button</button>
    </p>
    <p>
      <button id=add_lines>Add many lines</button>
    </p>
    <p>Results:</p>
    <pre id=results></pre>
    <script src="../lib/dialog-promise.js"></script>
<script>
window.addEventListener('load', function(){
    add_lines.addEventListener('click', function(){
        for(var i=1; i<=1000; i++){
            results.textContent+='\n'+'Adding line '+i;
        }
    });
    alert_example1.addEventListener('click', function(){
        alertPromise('First example').then(function(result){
            results.textContent+='\n'+'Alert window closed: '+result;
        });
    });
    confirm_example1.addEventListener('click', function(){
        confirmPromise('Do you like this example?').then(function(result){
            results.textContent+='\n'+'Alert window closed: '+result;
        });
    });
    prompt_example1.addEventListener('click', function(){
        promptPromise('What is your name?').then(function(result){
            results.textContent+='\n'+'You typed: '+result;
        });
    });
    toggle_close.addEventListener('click', function(){
        dialogPromise.withCloseButton=!dialogPromise.withCloseButton;
    });
});
    
function askPromise(opts) {
    if(typeof opts === 'string'){
        opts={
            message: opts,
            buttonList:[
               {label: 'Ok', returns: true, isDefault:true},
               {label: 'Cancel', returns: false},
            ],
            cancelValue: false
        }
    }
    var html = jsToHtml.html;
    return dialogPromise(function(mainElement, done){
        innerElement = html.div([
            html.div(opts.message),
            html.div({'class':'answer-buttons'}, opts.buttonList.map(function(buttonDef){
                var attrs={};
                if(buttonDef.isDefault){
                    attrs.autofocus=true;
                }
                var button=html.button(attrs, buttonDef.label).create();
                button.addEventListener('click', done.bind(null, buttonDef.returning));
                return button;
            }))
        ]).create();
        mainElement.appendChild(innerElement);
    });
}
</script>

</body>
</html>
